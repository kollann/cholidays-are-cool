"use strict";import Core_App from"./core.app.js?v=0.11";const app=document.getElementById("core_app");export default class Core_View{constructor(e,t){this.slug=e,this.template=t,window.addEventListener("templateChanged",this.listen.bind(this))}listen(e){e.detail.slug==this.slug&&this.init()}init(){window.Core.debugmode&&console.log("View loaded: "+this.slug)}isActive(){if(window.Core.utils.isEmpty(Core_View.getGetParameters()))return window.location.hash.substr(1).replace("#","")===this.slug;{let e=window.location.hash.substr(1).indexOf("?");return window.location.hash.substr(1,e).replace("#","")===this.slug}}renderMarkup(){Core_View.useTemplate(window.Core.system.webRoot+window.Core.system.templatesPath+"/"+this.template+".tpl",app,this.slug)}static useTemplate(e,t,i=null){return new Promise(s=>{$.get(e,(function(o){let r=o.match(/<%>.*<%>/gi);if(r)for(let e=0;e<r.length;e++){let t=r[e],i=t.replace(/<%>/gi,""),s=window.Core.t(i);o=o.replace(t,s)}t.innerHTML=o,"/login"===i?$("#logout").hide():$("#logout").show(),window.Core.getParams=Core_View.getGetParameters(),window.dispatchEvent(new CustomEvent("templateChanged",{detail:{slug:i,template:e}})),s()}))})}static getGetParameters(){let e=window.location.hash.substr(1).indexOf("?");if(-1!=e){return window.location.hash.substr(e+2).split("&").reduce((function(e,t){let i=t.split("=");return e[i[0]]=i[1],e}),{})}return{}}}